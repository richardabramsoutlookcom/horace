---
phase: 02-authentic-sprites
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [main.js]
autonomous: true

must_haves:
  truths:
    - "Vehicles look like blocky ZX Spectrum cars"
    - "Cars have distinct body colors (yellow/red based on direction)"
    - "Road scene uses authentic Spectrum visual style"
  artifacts:
    - path: "main.js"
      provides: "Vehicle sprite rendering in drawRoad()"
      contains: "drawVehicle"
  key_links:
    - from: "vehicle object"
      to: "drawVehicle helper"
      via: "forEach in drawRoad"
      pattern: "drawVehicle"
---

<objective>
Create authentic ZX Spectrum-style vehicle sprites for the road crossing scene.

Purpose: Replace the current simple rectangle vehicles with more recognizable blocky car sprites that match the original game's visual style.
Output: Updated vehicle rendering in drawRoad() with authentic Spectrum-style cars.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-visual-foundation/01-01-SUMMARY.md
@main.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create drawVehicle helper function</name>
  <files>main.js</files>
  <action>
Add a drawVehicle(vehicle) helper function near the other draw functions to render authentic Spectrum-style cars.

ZX Spectrum car characteristics:
- Blocky rectangular body (no curves)
- Single color body (BRIGHT_YELLOW for right-moving, BRIGHT_RED for left-moving)
- Simple rectangular "windows" in contrasting color
- Black "wheels" as small rectangles at bottom corners
- No gradients or smooth shapes - pure blocky pixels

Function structure:
```javascript
function drawVehicle(vehicle) {
  const isMovingRight = vehicle.speed > 0;
  const bodyColorName = isMovingRight ? 'BRIGHT_YELLOW' : 'BRIGHT_RED';
  const windowColorName = isMovingRight ? 'BLACK' : 'BRIGHT_YELLOW';

  // Main body - full rectangle
  ctx.fillStyle = ZX_PALETTE[bodyColorName];
  ctx.fillRect(vehicle.x, vehicle.y, vehicle.w, vehicle.h);

  // Windows - simple rectangles (2 windows per car)
  ctx.fillStyle = ZX_PALETTE[windowColorName];
  const windowW = Math.floor(vehicle.w * 0.2);
  const windowH = vehicle.h - 4;
  const windowY = vehicle.y + 2;
  // Front window
  ctx.fillRect(vehicle.x + Math.floor(vehicle.w * 0.6), windowY, windowW, windowH);
  // Back window
  ctx.fillRect(vehicle.x + Math.floor(vehicle.w * 0.2), windowY, windowW, windowH);

  // Wheels - black rectangles at bottom
  ctx.fillStyle = ZX_PALETTE.BLACK;
  ctx.fillRect(vehicle.x + 2, vehicle.y + vehicle.h - 3, 4, 3);
  ctx.fillRect(vehicle.x + vehicle.w - 6, vehicle.y + vehicle.h - 3, 4, 3);

  // Track in attribute system
  for (let vy = vehicle.y; vy < vehicle.y + vehicle.h; vy += 8) {
    for (let vx = vehicle.x; vx < vehicle.x + vehicle.w; vx += 8) {
      setAttr(vx, vy, bodyColorName, 'BLACK');
    }
  }
}
```

Keep it simple - authentic ZX Spectrum graphics were very blocky.
  </action>
  <verify>drawVehicle function exists in main.js</verify>
  <done>drawVehicle helper function created with Spectrum-style car rendering</done>
</task>

<task type="auto">
  <name>Task 2: Update drawRoad() to use drawVehicle</name>
  <files>main.js</files>
  <action>
Update the vehicle rendering section in drawRoad() (around lines 615-639) to use the new drawVehicle helper.

Replace the existing vehicles.forEach block:

FROM (existing complex inline rendering):
```javascript
vehicles.forEach((vehicle) => {
  const mainColorName = vehicle.speed > 0 ? 'BRIGHT_YELLOW' : 'BRIGHT_RED';
  // ... all the inline drawing code
});
```

TO (simple helper call):
```javascript
vehicles.forEach((vehicle) => {
  drawVehicle(vehicle);
});
```

This keeps drawRoad() cleaner and the vehicle rendering logic encapsulated.

Also ensure vehicles have consistent sizing for the 256x192 resolution:
- Vehicle width: 20-32 pixels (current random 24-40 may be too large)
- Vehicle height: 12-14 pixels

If needed, update resetRoad() vehicle creation to use slightly smaller dimensions that look proportional on the Spectrum resolution.
  </action>
  <verify>Run game, vehicles render using drawVehicle helper with blocky Spectrum style</verify>
  <done>drawRoad() uses drawVehicle helper for authentic vehicle rendering</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] drawVehicle() helper function exists
- [ ] drawRoad() uses drawVehicle() for all vehicles
- [ ] Vehicles appear as blocky Spectrum-style cars
- [ ] Yellow cars move right, red cars move left
- [ ] No JavaScript errors in browser console
</verification>

<success_criteria>
- All tasks completed
- Vehicles are visually recognizable as blocky Spectrum cars
- Consistent color scheme (yellow right, red left)
- Attribute system tracks vehicle colors correctly
</success_criteria>

<output>
After completion, create `.planning/phases/02-authentic-sprites/02-02-SUMMARY.md`
</output>
